<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Sign Up</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">


        <link rel = "stylesheet" href = "signup.css">
    </head>
    <body>
        <div class = "Signup-rectangle">
            <div class = "signUpText">
                <p class = "Signup">
                    Signup For An Account
                </p>
            </div>
            <div class = "Signup-Credentials">
                <div class = "username">
                    <p class = "username-header">New Email</p>
                    <input class = "Username-bar" type = "text" id = username placeholder = "Email">
                    <span id = "usermessage" style = "margin-left:50px; color:red"> </span>
                </div>
                <div class="password">
                    <p class = "password-header">Password</p>
                    <input type = "password" class = "Password-bar" value = "" placeholder = "Password" id = "pswd1">
                    <span id = "message1" style = "margin-left:50px; color : red"> </span>
                    <p class = "Password-strength">Password must contain <span class="req1"> 1. At least 8 characters</span> <span class = "req2">2. Contain at least 1 number</span></p>
                </div>
                <p class = "cpassword-header">Confirm Password</p>
                <input type = "password" class = "CPassword-bar" value = "" placeholder = "Confirm Password" id = "pswd2">
                <span id = "message2" style = "margin-left:50px; color:red"> </span>
            </div>
            <div class="bottom-row">
                <p class = "have-account">Already have an account? <a href = "http://127.0.0.1:5502/Screens/login%20and%20Signup%20with%20firebase/login.html" target = "_self" class = "underline"> Log in.</a></p>
                <button class = "account-creation" type = submit id = "signUpButton">Create Account</button>
            </div>
        </div>
    </body>
    <script src = "Signup.js"></script>
    <script type = "module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-auth.js";
        import { getDatabase } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-database.js";

        const firebaseConfig = {       
        apiKey: "AIzaSyBWImFGqsTT5oRab27BVDjzlicbegDW9qM",
        authDomain: "parkfast-23bd8.firebaseapp.com",
        databaseURL: "https://parkfast-23bd8-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "parkfast-23bd8",
        storageBucket: "parkfast-23bd8.appspot.com",
        messagingSenderId: "333155544674",
        appId: "1:333155544674:web:5cbbd8995095e3cd4c2b3b",
        measurementId: "G-5K5M61GXK1"
        };

        const app = initializeApp(firebaseConfig);
        window.database = getDatabase(app);
        window.auth = getAuth(app);

        document.getElementById('signUpButton').addEventListener('click', signUp);

        function signUp(){
        var pw1 = document.getElementById("pswd1").value;  
        var pw2 = document.getElementById("pswd2").value; 
        var email = document.getElementById("username").value;
        if (validateForm(pw1, pw2, email)){
            //window.open("http://127.0.0.1:5502/Screens/SearchDestination/SearchDestination.html", "_self");
            createUserWithEmailAndPassword(auth, email, pw1)
            .then((userCredential) => {
                const user = userCredential.user;
                alert ("Your account has been created successfully");
                window.open("http://127.0.0.1:5502/Screens/login%20and%20Signup%20with%20firebase/login.html", "_self");
            })
            .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;
                alert (errorMessage);
            })
            
        }
        }
    </script> 
</html>